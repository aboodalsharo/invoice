<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù†Ø¸Ø§Ù… Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø±Ø³Ù…ÙŠ</title>
<style>
    body {
        font-family: 'Arial', sans-serif;
        background-color: #f9f9f9;
        padding: 20px;
        direction: rtl;
    }
    h2 {
        text-align: center;
        color: #333;
    }
    .form-group {
        margin-bottom: 10px;
    }
    label {
        font-weight: bold;
    }
    input, textarea {
        padding: 8px;
        width: 100%;
        margin-top: 5px;
        border-radius: 5px;
        border: 1px solid #ccc;
        box-sizing: border-box;
    }
    button {
        padding: 10px 15px;
        margin-top: 10px;
        cursor: pointer;
        border: none;
        background-color: #2a7;
        color: white;
        border-radius: 5px;
    }
    table {
        width: 100%;
        margin-top: 20px;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: center;
    }
    th {
        background-color: #eee;
    }
    #searchBar {
        padding: 8px;
        width: 100%;
        margin-bottom: 10px;
        border: 1px solid #aaa;
        border-radius: 5px;
    }
</style>
</head>
<body>

<h2>ğŸ“‹ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ±</h2>

<div>
    <div class="form-group">
        <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ):</label>
        <input type="text" id="clientName">
    </div>
    <div class="form-group">
        <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
        <input type="text" id="phone">
    </div>
    <div class="form-group">
        <label>Ø§Ù„Ù…Ø¨Ù„Øº (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ):</label>
        <input type="number" id="amount">
    </div>
    <div class="form-group">
        <label>ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
        <textarea id="details" rows="3"></textarea>
    </div>
    <button onclick="addInvoice()">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>
    <button onclick="downloadCSV()">ğŸ’¾ Ø­ÙØ¸ ÙƒÙ…Ù„Ù CSV</button>
</div>

<hr>

<input type="text" id="searchBar" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„..." onkeyup="searchInvoice()">

<table id="invoiceTable">
    <thead>
        <tr>
            <th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
            <th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
            <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
            <th>ØªÙØ§ØµÙŠÙ„</th>
            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ÙØ§ØªÙˆØ±Ø©</th>
            <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>


   <script>
    // Ù…ØµÙÙˆÙØ© Ø§Ù„ÙÙˆØ§ØªÙŠØ±
    let invoices = [];

    // Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ®Ø²ÙŠÙ† ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­
    const STORAGE_KEY = "abood_invoices";

    // Ø­ÙØ¸ Ø§Ù„ÙÙˆØ§ØªÙŠØ± ÙÙŠ localStorage
    function saveInvoices() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(invoices));
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ù…Ù† localStorage
    function loadInvoices() {
        const data = localStorage.getItem(STORAGE_KEY);
        if (data) {
            try {
                invoices = JSON.parse(data);
            } catch (e) {
                invoices = [];
            }
        }
        renderTable();
    }

    // Ø¥Ø¶Ø§ÙØ© ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©
    function addInvoice() {
        const name = document.getElementById('clientName').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const amount = document.getElementById('amount').value.trim();
        const details = document.getElementById('details').value.trim();
        const today = new Date().toISOString().split('T')[0];

        if (!name || !amount) {
            alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ§Ù„Ù…Ø¨Ù„Øº");
            return;
        }

        invoices.push({name, phone, amount, details, date: today});
        saveInvoices();
        renderTable();

        document.getElementById('clientName').value = '';
        document.getElementById('phone').value = '';
        document.getElementById('amount').value = '';
        document.getElementById('details').value = '';
    }

    // Ø±Ø³Ù… Ø§Ù„Ø¬Ø¯ÙˆÙ„
    function renderTable(filtered = invoices) {
        const tbody = document.querySelector('#invoiceTable tbody');
        tbody.innerHTML = '';
        filtered.forEach((inv, index) => {
            tbody.innerHTML += `
                <tr>
                    <td><input type="text" value="${inv.name}" onchange="editInvoice(${index}, 'name', this.value)"></td>
                    <td><input type="text" value="${inv.phone}" onchange="editInvoice(${index}, 'phone', this.value)"></td>
                    <td><input type="number" value="${inv.amount}" onchange="editInvoice(${index}, 'amount', this.value)"></td>
                    <td><textarea onchange="editInvoice(${index}, 'details', this.value)">${inv.details}</textarea></td>
                    <td><input type="date" value="${inv.date}" onchange="editInvoice(${index}, 'date', this.value)"></td>
                    <td><button onclick="deleteInvoice(${index})">ğŸ—‘ï¸ Ø­Ø°Ù</button></td>
                </tr>
            `;
        });
    }

    // ØªØ¹Ø¯ÙŠÙ„ ÙØ§ØªÙˆØ±Ø©
    function editInvoice(index, field, value) {
        invoices[index][field] = value;
        saveInvoices();
    }

    // Ø­Ø°Ù ÙØ§ØªÙˆØ±Ø©
    function deleteInvoice(index) {
        invoices.splice(index, 1);
        saveInvoices();
        renderTable();
    }

    // ØªØ­Ù…ÙŠÙ„ ÙƒÙ€ CSV
    function downloadCSV() {
        let csvContent = "data:text/csv;charset=utf-8,Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„,Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ,Ø§Ù„Ù…Ø¨Ù„Øº,ØªÙØ§ØµÙŠÙ„,ØªØ§Ø±ÙŠØ® Ø§Ù„ÙØ§ØªÙˆØ±Ø©\n" +
            invoices.map(e => `${e.name},${e.phone},${e.amount},"${e.details}",${e.date}`).join("\n");
        const link = document.createElement("a");
        link.setAttribute("href", encodeURI(csvContent));
        link.setAttribute("download", "invoices.csv");
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ÙØ§ØªÙˆØ±Ø© Ø¨Ø§Ù„Ø§Ø³Ù…
    function searchInvoice() {
        const searchValue = document.getElementById('searchBar').value.toLowerCase();
        const filtered = invoices.filter(inv => inv.name.toLowerCase().includes(searchValue));
        renderTable(filtered);
    }

    // Ø£ÙˆÙ„ Ù…Ø§ ØªÙØªØ­ Ø§Ù„ØµÙØ­Ø©: Ø­Ù…Ù‘Ù„ Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø©
    loadInvoices();
</script>



</body>
</html>
